webpackJsonp([8],{"14rw":function(t,e,i){"use strict";var n=i("woOf"),o=i.n(n),r=i("fZjL"),a=i.n(r),s=i("Dd8w"),l=i.n(s),d={render:function(){var t=this.$createElement;return(this._self._c||t)("div")},staticRenderFns:[]},h=i("VU/8")(null,d,!1,null,null,null).exports,u=i("k6jg"),c={columns:{type:Array,default:function(){return[]}},detail:{type:Object,default:function(){return{columns:[],sortName:""}}},editFormFileds:{type:Object,default:function(){return{}}},editFormFields:{type:Object,default:function(){return{}}},editFormOptions:{type:Array,default:function(){return[]}},searchFormFileds:{type:Object,default:function(){return{}}},searchFormFields:{type:Object,default:function(){return{}}},searchFormOptions:{type:Array,default:function(){return[]}},table:{type:Object,default:function(){return{}}},extend:{type:Object,default:function(){return{}}}},f=i("mvHQ"),p=i.n(f),m=i("pFYg"),g=i.n(m),y=i("Gu7T"),v=i.n(y),b={loadInternalDetailTableBefore:function(t,e){this.detailOptions.delKeys.length>0&&(this.detailOptions.delKeys=[]);var i=this.table.key;return this.currentRow&&this.currentRow.hasOwnProperty(i)&&(t.value=this.currentRow[i]),this.loadDetailTableBefore(t,e)},detailRowOnChange:function(t){this.detailRowChange(t)},detailRowChange:function(t){},resetDetailTable:function(t){if(this.detailOptions.columns&&0!=this.detailOptions.columns.length){var e=this.table.key,i={value:t?t[e]:this.currentRow[e]};this.$refs.detail&&(this.$refs.detail.reset(),this.$refs.detail.load(i))}},refreshRow:function(){this.resetDetailTable()},addRow:function(){this.$refs.detail.addRow({})},delRow:function(){var t=this,e=this.$refs.detail.getSelected();return e&&0!=e.length?!!this.delDetailRow(e)&&void this.$Modal.confirm({title:"删除警告!",content:'<p style="color: red;font-weight: bold;letter-spacing: 3px;">确认要删除选择的数据吗?</p>',onOk:function(){e=t.$refs.detail.delRow();var i=t.detailOptions.key;e.forEach(function(e){e.hasOwnProperty(i)&&e[i]&&t.detailOptions.delKeys.push(e[i])})}}):this.$message.error("请选择要删除的行!")}},w={onInit:function(){console.log("Create执行前")},onInited:function(){console.log("Create执行后")},mounted:function(){console.log("mounted")},searchBefore:function(t){return console.log("表"+this.table.cnName+"触发loadTableBefore"),!0},searchAfter:function(t,e){return console.log("表"+this.table.cnName+"触发loadTableAfter"),!0},searchDetailBefore:function(t){return console.log(this.detailOptions.cnName+"触发loadDetailTableBefore"),!0},searchDetailAfter:function(t,e){return console.log(this.detailOptions.cnName+"触发loadDetailTableAfter"),!0},delBefore:function(t,e){return!0},delAfter:function(t){return!0},delDetailRow:function(t){return!0},addBefore:function(t){return!0},addAfter:function(t){return!0},updateBefore:function(t){return!0},updateAfter:function(t){return!0},auditBefore:function(t,e){return!0},auditAfter:function(t,e){return!0},resetAddFormBefore:function(){return!0},resetAddFormAfter:function(){return!0},resetUpdateFormBefore:function(){return!0},resetUpdateFormAfter:function(){return!0},modelOpenBefore:function(t){},modelOpenAfter:function(t){},importAfter:function(t){this.search()},reloadDicSource:function(){this.initDicKeys()},exportBefore:function(t){return!0}},x={parentCall:function(t){if("function"!=typeof t)return console.log("扩展组件需要传入一个回调方法才能获取父级Vue对象");t(this)},getCurrentAction:function(){return this.currentReadonly?"":"--"+(this.currentAction==this.const.ADD?"新增":"编辑")},quickSearchKeyPress:function(t){13==t.keyCode&&""!=this._searchFormFields[this.singleSearch.field]&&this.search()},getButtons:function(){var t=this,e=this.buttons.findIndex(function(t){return"Search"==t.value});if(-1!=e&&this.buttons.splice(e+1,0,{icon:"ios-arrow-down",class:"r-dropdown",name:"",type:this.buttons[e].type,onClick:function(){t.searchBoxShow=!t.searchBoxShow}}),this.maxBtnLength+=-1==e?0:1,this.buttons.length<=this.maxBtnLength)return this.buttons;var i=this.buttons.slice(0,this.maxBtnLength);return i[this.maxBtnLength-1].last=!0,i},extendBtn:function(t,e){t&&e&&e instanceof Array&&e.forEach(function(e){t.splice(void 0==e.index?t.length:e.index,0,e)})},initBoxButtons:function(){var t,e,i=this,n=this.$route.path,o=this.permission.getButtons(n,null,this.extend.tableAction);o&&o.forEach(function(t){var e={};for(var n in t)e[n]=t[n];i.buttons.push(e)}),this.extend||(this.extend={}),this.extend.buttons||(this.extend.buttons={}),this.extend.buttons.view&&this.extendBtn(this.buttons,this.extend.buttons.view);var r=[],a=this.buttons.some(function(t){if(t.value&&(t.value.toLowerCase()==i.const.ADD.toLowerCase()||t.value.toLowerCase()==i.const.EDIT.toLowerCase()))return!0});this.currentReadonly=!a;var s,l={name:"刷新",icon:"md-refresh",onClick:function(){this.currentAction!=this.const.ADD&&this.refreshRow()}};if(this.buttons.some(function(t){if(t.value==i.const.IMPORT)return!0})&&(this.upload.url=this.getUrl(this.const.IMPORT),this.upload.template.fileName=this.table.cnName,this.upload.template.url=this.http.ipAddress+this.getUrl(this.const.DOWNLOADTEMPLATE,!0)),!a)return this.editFormOptions.forEach(function(t){t.forEach(function(t){t.disabled=!0})}),this.detail.columns.forEach(function(t){t.hasOwnProperty("edit")&&(t.edit=!1)}),this.extendBtn(r,this.extend.buttons.box),(s=this.boxButtons).push.apply(s,r),this.detailOptions.buttons.push(l),this.extendBtn(this.detailOptions.buttons,this.extend.buttons.detail),r;this.detailOptions.edit=!0,r.push.apply(r,[{name:"保 存",icon:"md-checkmark",type:"error",onClick:function(){this.save()}},{name:"重 置",icon:"md-refresh",type:"success",onClick:function(){this.resetEdit()}}]),(t=this.detailOptions.buttons).push.apply(t,[{name:"添加行",icon:"md-add",onClick:function(){this.addRow()}},{name:"删除行",icon:"md-close",onClick:function(){this.delRow()}}]),this.extendBtn(r,this.extend.buttons.box),this.detailOptions.buttons.push(l),this.extendBtn(this.detailOptions.buttons,this.extend.buttons.detail),(e=this.boxButtons).push.apply(e,r)},onClick:function(t){t.apply(this)},changeDropdown:function(t,e){var i=this.buttons.filter(function(e){return e.name==t});i&&i.length>0&&i[0].onClick.apply(this)},emptyValue:function(t){return null===t||void 0===t||""===t},getSearchParameters:function(){var t=this;this.fiexdSearchForm||(this.searchBoxShow=!1);var e={wheres:[]},i=function(i){var n=t._searchFormFields[i];if(t.emptyValue(n))return"continue";"number"==typeof n&&(n+="");var o=t.getSearchItem(i);if("string"==typeof n||-1==["date","datetime"].indexOf(o))return e.wheres.push({name:i,value:"string"!=typeof n&&n?n.join(","):n,displayType:o}),"continue";for(var r=function(t){e.wheres.push({name:i,value:n[t],displayType:-1!=["date","datetime"].indexOf(o)?t?"lessorequal":"thanorequal":o})},a=0;a<n.length;a++)r(a)};for(var n in this._searchFormFields)i(n);return e},search:function(){this.$refs.table.load(null,!0)},loadTableBefore:function(t,e){var i=this.getSearchParameters();i&&(t=o()(t,i)),e(this.searchBefore(t))},loadTableAfter:function(t,e){e(this.searchAfter(t))},loadDetailTableBefore:function(t,e){if(this.currentAction==this.const.ADD)return e(!1),!1;e(this.searchDetailBefore(t))},loadDetailTableAfter:function(t,e){e(this.searchDetailAfter(t))},getSearchItem:function(t){for(var e=void 0,i=0;i<this.searchFormOptions.length;i++){if(e)return e.type;e=this.searchFormOptions[i].find(function(e){return e.field==t})}return e.type},resetSearch:function(){this.resetSearchForm(),this.resetSearchFormAfter&&this.resetSearchFormAfter()},resetEdit:function(){var t=this.currentAction!=this.const.ADD;if(this[t?"resetUpdateFormBefore":"resetAddFormBefore"]()){var e={};t&&(e[this.table.key]=this._editFormFields[this.table.key]),this.resetEditForm(e),this[t?"resetUpdateFormAfter":"resetAddFormAfter"]()}},resetSearchForm:function(t){this.resetForm("searchForm",t)},resetEditForm:function(t){this.hasDetail&&this.$refs.detail&&this.$refs.detail.reset(),this.resetForm("form",t)},getKeyValueType:function(t,e){var i=this;try{var n=(e?"e":"s")+"_b_";t.forEach(function(t){t.forEach(function(t){if(i.keyValueType.hasOwnProperty(n+t.field))return!0;var e=void 0;"switch"==t.type?i.keyValueType[t.field]=1:t.bind&&t.bind.data?e=t.bind.data:t.data&&(t.data instanceof Array?e=t.data:t.data.data&&t.data.data instanceof Array&&(e=t.data.data)),e&&e.length>0&&!i.keyValueType.hasOwnProperty(t.field)&&(i.keyValueType[t.field]=e[0].key,i.keyValueType[n+t.field]=t.type)})})}catch(t){console.log(t.message)}},resetForm:function(t,e){if(this.$refs[t]&&this.$refs[t].reset(),e){var i=void 0,n=void 0;for(var o in"searchForm"==t?(i=this._searchFormFields,n="s_b_"):(i=this._editFormFields,n="e_b_"),this.keyValueType._dinit||(this.getKeyValueType(this.editFormOptions,!0),this.getKeyValueType(this.searchFormOptions,!1),this.keyValueType._dinit=!0),i)if(e.hasOwnProperty(o)){var r=e[o],a=this.keyValueType[n+o];"selectList"==a||"checkbox"==a||"cascader"==a?""!=r&&void 0!=r&&"string"==typeof r?r=r.split(","):"checkbox"==a&&(r=[]):this.keyValueType.hasOwnProperty(o)&&"number"==typeof this.keyValueType[o]&&1*r==r?r*=1:null==r||void 0==r?r="":r+="",i[o]=r}else i[o]=i[o]instanceof Array?[]:""}},onBtnClick:function(t){this[t.method](t.data)},refresh:function(){this.search()},saveBefore:function(t){return!0},saveAfter:function(t,e){return!0},save:function(){var t=this;this.$refs.form.validate(function(e){e&&t.saveExecute()})},saveExecute:function(){var t=this,e={};for(var i in this._editFormFields)if(this.uploadfiled&&this.uploadfiled.length>0&&-1!=this.uploadfiled.indexOf(i)&&this._editFormFields[i]instanceof Array){var n=this._editFormFields[i].map(function(t){return t.path});e[i]=n.join(",")}else e[i]=this._editFormFields[i];for(var o in e)e[o]instanceof Array&&(e[o]=e[o].join(","));var r={mainData:e,detailData:null,delKeys:null};if(this.hasDetail&&(r.detailData=this.$refs.detail.rowData),this.detailOptions.delKeys.length>0&&(r.delKeys=this.detailOptions.delKeys),this.currentAction==this.const.ADD){if(!this.addBefore(r))return}else if(!this.updateBefore(r))return;var a=this.getUrl(this.currentAction);this.http.post(a,r,!0).then(function(e){if(t.currentAction==t.const.ADD){if(!t.addAfter(e))return}else if(!t.updateAfter(e))return;if(!e.status)return t.$error(e.message);if(t.$success(e.message),t.boxOptions.saveClose)return t.boxModel=!1,void t.refresh();var i,n=void 0;(n="string"==typeof e.data&&""!=e.data?JSON.parse(e.data):e.data,t.currentAction==t.const.ADD&&(t._editFormFields[t.table.key]="",t.currentAction=t.const.EDIT,t.currentRow=n.data),t.resetEditForm(n.data),t.hasDetail)&&(t.detailOptions.delKeys=[],n.list&&(i=t.$refs.detail.rowData).push.apply(i,v()(n.list)));t.refresh()})},del:function(){var t=this,e=this.$refs.table.getSelected();if(0==e.length)return this.$error("请选择要删除的行!");var i=e.map(function(e){return e[t.table.key]});if(!i||0==i.length)return this.$error("没有获取要删除的行数据!");if(this.delBefore(i,e)){var n=!1;this.$Modal.confirm({title:"删除警告!",content:'<p style="color: red;font-weight: bold;letter-spacing: 3px;">确认要删除选择的数据吗?</p>',onOk:function(){if(!n){n=!0;var e=t.getUrl(t.const.DEL);t.http.post(e,i,"正在删除数据....").then(function(e){if(!e.status)return t.$error(e.message);t.$success(e.message),t.delAfter(e)&&t.refresh()})}}})}},initBox:function(){this.modelOpenBefore(this.currentRow),this.boxInit||(this.boxInit=!0,this.boxModel=!0)},setEditForm:function(t){var e=this;this.$refs.table.remoteColumns.forEach(function(t){e.editFormOptions.forEach(function(e){e.forEach(function(e){e.field==t.field&&(e.data.data=o()([],e.data,t.bind.data))})})}),this._editFormFields,this._editFormFields[this.table.key]=t[this.table.key],this.resetEditForm(t),this.currentAction=this.const.EDIT,this.boxModel=!0},linkData:function(t,e){this.currentAction=this.const.EDIT,this.currentRow=t,this.initBox(),this.resetDetailTable(t),this.setEditForm(t),this.getRemoteFormDefaultKeyValue(),this.modelOpenProcess(t)},add:function(){this.currentAction=this.const.ADD,this.currentRow={},this.initBox(),this.hasDetail&&this.$refs.detail&&this.$refs.detail.reset();var t={};this.editFormOptions.forEach(function(e){e.forEach(function(e){"switch"==e.type&&(t[e.field]=1)})}),this.resetEditForm(t),this.boxModel=!0,this.modelOpenProcess()},edit:function(){var t=this.$refs.table.getSelected();if(0==t.length)return this.$error("请选择要编辑的行!");this.currentRow=t[0],this.initBox(),this.resetDetailTable(),this.setEditForm(t[0]),this.getRemoteFormDefaultKeyValue(),this.modelOpenProcess(t[0])},getRemoteFormDefaultKeyValue:function(){var t=this;this.currentAction==this.const.EDIT&&0!=this.remoteKeys.length&&this.editFormOptions.forEach(function(e,i){e.forEach(function(e,n){if(e.remote){var o=t.columns.find(function(t){return t.bind&&t.bind.key==e.dataKey});if(!o)return;var r=t.currentRow[e.field],a=o.bind.data.find(function(t){return t.key==r});e.data=[{key:r,value:a?a.value:r}],t.editFormOptions[i].splice(n,1,e)}})})},modelOpenProcess:function(t){var e=this;this.$nextTick(function(){e.modelOpenAfter(t)})},import:function(){this.upload.excel=!0,this.$refs.upload_excel&&this.$refs.upload_excel.reset()},download:function(t,e){var i=new XMLHttpRequest;i.open("GET",t,!0),i.setRequestHeader("Content-type","application/json"),i.setRequestHeader("Authorization",this.$store.getters.getToken());var n=this.$refs.export;i.responseType="blob",i.onload=function(t){if(200==i.status){var o=i.response;n.download=e;var r=new Blob([o]);n.href=URL.createObjectURL(r),n.click()}else this.$error("下载文件出错了..")},i.send()},export:function(){var t=this,e=this.getUrl(this.const.EXPORT),i=this.getSearchParameters(),n={order:this.pagination.order,wheres:i.wheres||[]};if(this.exportBefore(n)){n.wheres&&"object"==g()(n.wheres)&&(n.wheres=p()(n.wheres));var o=this.http;o.post(e,n,"正在导出数据....").then(function(e){if(!e.status)return t.$error(e.message);var i=t.getUrl(t.const.DOWNLOAD);i="/"==i[0]?i.substring(1):i,t.download(o.ipAddress+i+"?path="+e.data,t.table.cnName+".xlsx")})}},getSelectRows:function(){return this.$refs.table.getSelected()},getDetailSelectRows:function(){return this.$refs.detail?this.$refs.detail.getSelected():[]},audit:function(){var t=this.$refs.table.getSelected();return 0==t.length?this.$error("请选择要审核的行!"):t.every(function(t){return t.AuditStatus>0})?this.$error("只能选择审核中的数据!"):(this.auditParam.rows=t.length,void(this.auditParam.model=!0))},saveAudit:function(){var t=this,e=this.$refs.table.getSelected();if(-1==this.auditParam.status)return this.$error("请选择审核结果!");if(e.length!=this.auditParam.rows)return this.$error("所选数据已发生变化,请重新选择审数据!");var i=e.map(function(e){return e[t.table.key]});if(this.auditBefore(i,e)){var n=this.getUrl(this.const.AUDIT)+"?auditReason="+this.auditParam.reason+"&auditStatus="+this.auditParam.status;this.http.post(n,i,"审核中....").then(function(i){if(t.auditAfter(i,e)){if(!i.status)return t.$error(i.message);t.auditParam.rows=0,t.auditParam.status=-1,t.auditParam.reason="",t.auditParam.model=!1,t.$success(i.message),t.refresh()}})}},openViewColumns:function(){var t,e=this;0==this.viewColumns&&((t=this.viewColumns).push.apply(t,[{title:"名称",key:"title"},{title:"字段",key:"field"},{title:"类型",key:"type"},{title:"是否显示",key:"hidden"},{title:"绑定数据源",key:"bind"}]),this.columns.forEach(function(t){e.viewData.push({title:t.title,field:t.field,type:t.type,hidden:t.hidden?"否":"是",bind:t.bind?t.bind.dicNo:"--",cellClassName:{title:"table-info-cell-title"}})}));this.viewModel=!0},viewModelCancel:function(){this.viewModel=!1},initFormOptions:function(t,e,i,n){var r=this;t.forEach(function(t){t.forEach(function(t){if("img"!=t.type&&"excel"!=t.type&&"file"!=t.type&&"img"!=t.columnType||(t.url=r.http.ipAddress+"api"+r.table.url+"Upload",r.uploadfiled.push(t.field)),!t.dataKey)return!0;if(t.remote)return r.remoteKeys.push(t.dataKey),t.data=[],!0;if("checkbox"!=t.type||i[t.field]instanceof Array||(i[t.field]=[]),-1==e.indexOf(t.dataKey)){e.push(t.dataKey);var a={dicNo:t.dataKey,data:[]};n&&(a.e_type=t.type),r.dicKeys.push(a)}o()(t,r.dicKeys.filter(function(e){return e.dicNo==t.dataKey})[0])})})},initColumns:function(t,e,i){var n=this;t&&t instanceof Array&&t.forEach(function(t){if(!t.bind||t.bind.data&&t.bind.data.length>0)return!0;var o=t.bind.key||t.bind.dicNo;if(-1!=n.remoteKeys.indexOf(o))return t.bind.remote=!0,!0;-1==n.hasKeyField.indexOf(t.field)&&n.hasKeyField.push(t.field);var r=e.filter(function(t){return t.dicNo==o});r&&0!=r.length||(e.push({dicNo:o,config:"",data:[]}),r=[e[e.length-1]],i.push(o)),t.bind=r[0],t.bind.type=t.bind.e_type||"string"})},bindOptions:function(t){var e=this;t.forEach(function(t){e.dicKeys.forEach(function(i){if(i.dicNo!=t.dicNo)return!0;if(t.data.length>0&&!t.data[0].hasOwnProperty("key")){for(var n,o=t.data,r=new Array(o.length),a=0;a<o.length;a++)r[a]={key:o.key+"",value:o.value};(n=i.data).push.apply(n,r)}else{var s;"selectList"==i.e_type&&t.data.length>0&&"number"==typeof t.data[0].key&&t.data.forEach(function(t){t.key=t.key+""}),(s=i.data).push.apply(s,v()(t.data))}var l;e.singleSearch&&e.singleSearch.dataKey&&e.singleSearch.dataKey==i.dicNo&&(l=e.singleSearch.data).splice.apply(l,[0,1].concat(v()(i.data)))})})},getUrl:function(t,e){return(e?"":"/")+"api"+this.table.url+t},initDicKeys:function(){var t=[];if(this.dicKeys.splice(0),this.initFormOptions(this.editFormOptions,t,this._editFormFields,!0),this.initFormOptions(this.searchFormOptions,t,this._searchFormFields,!1),this.searchFormOptions.forEach(function(t){t.forEach(function(t){"date"!=t.type&&"datetime"!=t.type||(t.range=!0)})}),this.initColumns(this.columns,this.dicKeys,t),this.detailOptions&&this.detailOptions.columns&&this.initColumns(this.detailOptions.columns,this.dicKeys,t),this.searchFormOptions.length>0&&(this.singleSearch={dataKey:this.searchFormOptions[0][0].dataKey,dicNo:this.searchFormOptions[0][0].dicNo,field:this.searchFormOptions[0][0].field,title:this.searchFormOptions[0][0].title,type:this.searchFormOptions[0][0].type,data:[]}),0!=t.length){var e=this;this.http.post("/api/Sys_Dictionary/GetVueDictionary",t).then(function(t){e.bindOptions(t)})}},setFiexdColumn:function(t,e){var i=0;if(t.forEach(function(t){!t.hidden&&t.width&&(i+=t.width)}),i>e){var n=t.find(function(t){return!t.hidden});n&&(n.fixed=!0)}},initBoxHeightWidth:function(){var t=document.documentElement.clientHeight;t=t<250?250:t;var e=document.documentElement.clientWidth;this.boxOptions.height&&this.boxOptions.height>.8*t&&(this.boxOptions.height=.8*t),this.boxOptions.width&&this.boxOptions.width>.8*e&&(this.boxOptions.width=.8*e);var i=e-270;if(this.setFiexdColumn(this.columns,i),this.height=this.tableHeight||t-210,this.url=this.getUrl(this.const.PAGE),this.detail.columns&&this.detail.columns.length>0)this.hasDetail=!0,e*=.8,t*=.82,this.detailOptions.height||(this.detailOptions.height=t-57*this.editFormOptions.length-205,this.detailOptions.height=this.detailOptions.height<240?240:this.detailOptions.height),this.detailOptions.columns=this.detail.columns,this.detailOptions.pagination.sortName=this.detail.sortName,this.detailOptions.cnName=this.detail.cnName,this.detailOptions.key=this.detail.key,this.detailOptions.url=this.getUrl("getDetailPage"),this.setFiexdColumn(this.detail.columns,e);else{var n=1;this.editFormOptions.forEach(function(t){t.length>n&&(n=t.length)});var o=.7;e*=n/10+.3,t*=o=(o=.1*(this.editFormOptions.length||1)+.03)>.9?.9:o}this.boxOptions.height||(this.boxOptions.height=t),this.boxOptions.width||(this.boxOptions.width=e)},rowOnChange:function(t){this.rowChange(t)},rowChange:function(t){},$error:function(t){this.$Message.error({content:t,duration:5})},$success:function(t){this.$Message.success({content:t,duration:3})},setFiexdSearchForm:function(t){this.fiexdSearchForm=!0;var e=this.buttons.find(function(t){return"刷 新"==t.name});t&&(this.searchBoxShow=!0),e&&(e.name="重 置",e.onClick=function(){this.resetSearch()})}},F=x=o()(x,b,w),O=(i("lJIO"),i("4VqB"),{EDIT:"update",ADD:"Add",VIEW:"view",PAGE:"getPageData",AUDIT:"audit",DEL:"del",EXPORT:"Export",DOWNLOAD:"DownLoadFile",DOWNLOADTEMPLATE:"DownLoadTemplate",IMPORT:"Import",UPLOAD:"Upload"}),k={gridHeader:h,gridBody:h,gridFooter:h,modelHeader:h,modelBody:h,modelFooter:h},D={components:l()({},k,{VolForm:function(){return i.e(22).then(i.bind(null,"ifJF"))},VolBoxForm:function(){return i.e(21).then(i.bind(null,"R/er"))},VolTable:u.a,VolBox:function(){return i.e(19).then(i.bind(null,"mRGL"))},QuickSearch:function(){return i.e(26).then(i.bind(null,"xln9"))},Audit:function(){return i.e(27).then(i.bind(null,"uSAI"))},UploadExcel:function(){return i.e(23).then(i.bind(null,"DTwg"))}}),props:{},data:function(){return{_searchFormFields:{},_editFormFields:{},fiexdSearchForm:!1,_inited:!1,single:!1,const:O,boxInit:!1,searchBoxShow:!1,singleSearch:{},exportHref:"",currentAction:O.ADD,currentRow:{},closable:!1,boxModel:!1,width:700,labelWidth:100,viewModel:!1,viewColumns:[],viewData:[],maxBtnLength:3,buttons:[],splitButtons:[],uploadfiled:[],boxButtons:[],dicKeys:[],hasKeyField:[],keyValueType:{_dinit:!1},url:"",hasDetail:!1,initActivated:!1,load:!0,activatedLoad:!1,summary:!1,remoteKeys:[],detailOptions:{buttons:[],cnName:"",key:"",data:[],columns:[],edit:!0,single:!1,load:!0,delKeys:[],url:"",pagination:{total:0,size:100,sortName:""},height:0,doubleEdit:!0,clickEdit:!1,currentReadonly:!1,beginEdit:function(t,e,i){return!0},endEditBefore:function(t,e,i){return!0},endEditAfter:function(t,e,i){return!0}},auditParam:{rows:0,model:!1,status:-1,reason:"",data:[{text:"通过",status:1},{text:"拒绝",status:2}]},upload:{excel:!1,url:"",template:{url:"",fileName:""},init:!1},height:0,tableHeight:0,tableMaxHeight:0,pagination:{total:0,size:30,sortName:""},boxOptions:{saveClose:!0,labelWidth:100,height:0,width:0,summary:!1}}},methods:{mergeComponents:function(){if(this.extend.components)for(var t in this.extend.components)this.extend.components[t]?this.$options.components[t]=this.extend.components[t]:this.$options.components[t]=h}},activated:function(){this.onActivated&&this.onActivated(),this._inited?(this.activatedLoad&&this.refresh(),this.mergeComponents()):this._inited=!0},mounted:function(){this.mounted()},created:function(){if(this._searchFormFields=a()(this.searchFormFields).length?this.searchFormFields:this.searchFormFileds,this._editFormFields=a()(this.editFormFields).length?this.editFormFields:this.editFormFileds,this,this,this.mergeComponents(),this.extend.methods)for(var t in this.extend.methods)this[t]=this.extend.methods[t];this.pagination.sortName=this.table.sortName||this.table.key,this.initBoxButtons(),this.onInit(),this.initBoxHeightWidth(),this.initDicKeys(),this.onInited(),this.splitButtons=this.getButtons()},beforeUpdate:function(){},updated:function(){}};D.props=o()(D.props,c),D.methods=o()(D.methods,F,c.extend.methods);var C=D,E={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"layout-container"},[i("a",{ref:"export",attrs:{href:t.exportHref}}),t._v(" "),i("vol-box",{attrs:{model:t.viewModel,height:450,width:t.width,title:t.table.cnName+"数据结构"},on:{"update:model":function(e){t.viewModel=e}}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("Table",{attrs:{columns:t.viewColumns,data:t.viewData}})],1)]),t._v(" "),i("vol-box",{attrs:{model:t.auditParam.model,height:300,width:550,title:t.table.cnName+"--审核"},on:{"update:model":function(e){t.$set(t.auditParam,"model",e)}}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("Audit",{attrs:{auditParam:t.auditParam}})],1),t._v(" "),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("Button",{attrs:{type:"success",icon:"md-checkmark-circle"},on:{click:t.saveAudit}},[t._v("审核")])],1)]),t._v(" "),t.upload.url?i("vol-box",{attrs:{model:t.upload.excel,height:285,width:600,title:t.table.cnName+"--导入"},on:{"update:model":function(e){t.$set(t.upload,"excel",e)}}},[i("UploadExcel",{ref:"upload_excel",attrs:{url:t.upload.url,template:t.upload.template},on:{importExcelAfter:t.importAfter}})],1):t._e(),t._v(" "),i("gridHeader",{ref:"gridHeader",on:{parentCall:t.parentCall}}),t._v(" "),i("div",{staticClass:"view-container"},[i("div",{staticClass:"grid-search"},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.searchBoxShow,expression:"searchBoxShow"}],class:[t.fiexdSearchForm?"fiexd-search-box":"search-box"]},[i("vol-form",{ref:"searchForm",attrs:{"label-width":t.labelWidth,formRules:t.searchFormOptions,formFields:t._searchFormFields}},[t.fiexdSearchForm?t._e():i("div",{staticClass:"form-closex",attrs:{slot:"footer"},slot:"footer"},[i("Button",{attrs:{size:"small",type:"info",ghost:""},on:{click:t.search}},[i("Icon",{attrs:{type:"md-search"}}),t._v("查询\n            ")],1),t._v(" "),i("Button",{attrs:{size:"small",type:"success",ghost:""},on:{click:t.resetSearch}},[i("Icon",{attrs:{type:"md-refresh"}}),t._v("重置\n            ")],1),t._v(" "),i("Button",{attrs:{size:"small",type:"warning",ghost:""},on:{click:function(e){t.searchBoxShow=!t.searchBoxShow}}},[i("Icon",{attrs:{type:"md-power"}}),t._v("关闭\n            ")],1)],1)])],1),t._v(" "),i("div",{staticClass:"view-header"},[i("div",{staticClass:"desc-text"},[i("Icon",{attrs:{type:"md-apps"}}),t._v(" "),i("span",[t._v(t._s(t.table.cnName))])],1),t._v(" "),i("div",{staticClass:"notice"},[i("a",{staticClass:"text",attrs:{title:t.extend.text}},[t._v(t._s(t.extend.text))])]),t._v(" "),i("div",{staticClass:"search-line"},[t.singleSearch?i("QuickSearch",{attrs:{singleSearch:t.singleSearch,searchFormFields:t._searchFormFields,tiggerPress:t.quickSearchKeyPress}}):t._e()],1),t._v(" "),i("div",{staticClass:"btn-group"},[t._l(t.splitButtons,function(e,n){return i("Button",{key:n,class:e.class,attrs:{type:e.type},on:{click:function(i){t.onClick(e.onClick)}}},[i("Icon",{attrs:{type:e.icon}}),t._v("\n            "+t._s(e.name)+"\n          ")],1)}),t._v(" "),t.buttons.length>t.maxBtnLength?i("Dropdown",{attrs:{trigger:"click"},on:{"on-click":t.changeDropdown}},[i("Button",{attrs:{type:"info",ghost:""}},[t._v("\n              更多\n              "),i("Icon",{attrs:{type:"ios-arrow-down"}})],1),t._v(" "),i("DropdownMenu",{attrs:{slot:"list"},slot:"list"},t._l(t.buttons.slice(t.maxBtnLength,t.buttons.length),function(e,n){return i("DropdownItem",{key:n,attrs:{name:e.name}},[i("Icon",{attrs:{type:e.icon}}),t._v("\n                "+t._s(e.name)+"\n              ")],1)}),1)],1):t._e()],2)]),t._v(" "),t.boxInit?i("vol-box",{attrs:{model:t.boxModel,title:t.table.cnName+t.getCurrentAction(),width:t.boxOptions.width,height:t.boxOptions.height,padding:0},on:{"update:model":function(e){t.boxModel=e}}},[i("div",{staticClass:"iview-com",attrs:{slot:"content"},slot:"content"},[i("modelHeader",{ref:"modelHeader",staticClass:"model-header",on:{parentCall:t.parentCall}}),t._v(" "),i("div",{staticClass:"item form-item"},[i("div",{staticClass:"form-text v-text"},[i("span",{staticClass:"title"},[i("Icon",{attrs:{type:"ios-create-outline"}}),t._v("\n                "+t._s(t.table.cnName)+"\n              ")],1)]),t._v(" "),i("vol-form",{ref:"form",attrs:{"label-width":t.boxOptions.labelWidth,formRules:t.editFormOptions,formFields:t._editFormFields}})],1),t._v(" "),i("modelBody",{ref:"modelBody",staticClass:"model-body",on:{parentCall:t.parentCall}}),t._v(" "),t.detail.columns&&t.detail.columns.length>0?i("div",{staticClass:"grid-detail table-item item"},[i("div",{staticClass:"toolbar"},[i("div",{staticClass:"title form-text"},[i("span",[i("Icon",{attrs:{type:"md-list-box"}}),t._v("\n                  "+t._s(t.detail.cnName)+"\n                ")],1)]),t._v(" "),i("div",{staticClass:"btns"},t._l(t.detailOptions.buttons,function(e,n){return i("Button",{directives:[{name:"show",rawName:"v-show",value:!e.hasOwnProperty("hidden")||!e.hidden,expression:"!btn.hasOwnProperty('hidden')||!btn.hidden"}],key:n,attrs:{type:"dashed",ghost:"",icon:e.icon,size:"small"},on:{click:function(i){t.onClick(e.onClick)}}},[t._v(t._s(e.name))])}),1)]),t._v(" "),i("vol-table",{ref:"detail",attrs:{url:t.detailOptions.url,index:t.detailOptions.edit,tableData:t.detailOptions.data,columns:t.detailOptions.columns,pagination:t.detailOptions.pagination,height:t.detailOptions.height,single:t.detailOptions.single,"pagination-hide":!1,defaultLoadPage:t.detailOptions.load,doubleEdit:t.detailOptions.doubleEdit,beginEdit:t.detailOptions.beginEdit,endEditBefore:t.detailOptions.endEditBefore,endEditAfter:t.detailOptions.endEditAfter,summary:t.detailOptions.summary,"click-edit":t.detailOptions.clickEdit},on:{loadBefore:t.loadInternalDetailTableBefore,loadAfter:t.loadDetailTableAfter,rowChange:t.detailRowOnChange}})],1):t._e(),t._v(" "),i("modelFooter",{ref:"modelFooter",staticClass:"model-footer",on:{parentCall:t.parentCall}})],1),t._v(" "),i("div",{attrs:{slot:"footer"},slot:"footer"},[t._l(t.boxButtons,function(e,n){return i("Button",{directives:[{name:"show",rawName:"v-show",value:!e.hasOwnProperty("hidden")||!e.hidden,expression:"!btn.hasOwnProperty('hidden')||!btn.hidden"}],key:n,attrs:{type:e.type,disabled:e.hasOwnProperty("disabled")&&!!e.disabled},on:{click:function(i){t.onClick(e.onClick)}}},[i("Icon",{attrs:{type:e.icon}}),t._v("\n            "+t._s(e.name)+"\n          ")],1)}),t._v(" "),i("Button",{attrs:{type:"info"},on:{click:function(e){t.boxModel=!1}}},[i("Icon",{attrs:{type:"md-close"}}),t._v("关闭\n          ")],1)],2)]):t._e()],1),t._v(" "),i("gridBody",{ref:"gridBody",on:{parentCall:t.parentCall}}),t._v(" "),i("div",{staticClass:"grid-container"},[i("vol-table",{ref:"table",attrs:{single:t.single,tableData:[],linkView:t.linkData,columns:t.columns,pagination:t.pagination,height:t.height,"max-height":t.tableMaxHeight,"pagination-hide":!1,url:t.url,defaultLoadPage:t.load,summary:t.summary},on:{loadBefore:t.loadTableBefore,loadAfter:t.loadTableAfter,rowChange:t.rowOnChange}})],1)],1),t._v(" "),i("gridFooter",{ref:"gridFooter",on:{parentCall:t.parentCall}})],1)},staticRenderFns:[]};var A=i("VU/8")(C,E,!1,function(t){i("dCQd"),i("oWYQ")},"data-v-684c885b",null);e.a=A.exports},"4VqB":function(t,e){},Cdx3:function(t,e,i){var n=i("sB3e"),o=i("lktj");i("uqUo")("keys",function(){return function(t){return o(n(t))}})},Dd8w:function(t,e,i){"use strict";e.__esModule=!0;var n,o=i("woOf"),r=(n=o)&&n.__esModule?n:{default:n};e.default=r.default||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}},FVtQ:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={components:{gridHeader:"",gridBody:"",gridFooter:"",modelHeader:"",modelBody:"",modelFooter:""},buttons:[],methods:{onInit:function(){this.columns.forEach(function(t){"ParentId"==t.field&&(t.title="上级角色",t.bind={key:"t_roles"})}),this.editFormOptions.forEach(function(t){t.forEach(function(t){"ParentId"==t.field&&(t.min=0),"ParentId"==t.field&&(t.title="上级角色",t.type="select",t.dataKey="roles")})})},onInited:function(){}}},o={components:{ViewGrid:i("14rw").a},data:function(){return{table:{key:"Role_Id",footer:"Foots",cnName:"角色管理",name:"Sys_Role",url:"/Sys_Role/",sortName:"Role_Id"},extend:n,editFormFileds:{ParentId:"",RoleName:"",DeptName:"",Enable:"",Creator:"",CreateDate:"",Modifier:"",ModifyDate:""},editFormOptions:[[{title:"父级ID",required:!0,field:"ParentId",type:"number"},{title:"角色名称",required:!0,field:"RoleName"}],[{title:"部门名称",field:"DeptName"},{dataKey:"enable",title:"是否启用",field:"Enable",type:"switch"}],[{title:"创建人",field:"Creator",disabled:!0},{title:"创建时间",field:"CreateDate",disabled:!0,type:"datetime"}],[{title:"修改人",field:"Modifier",disabled:!0},{title:"修改时间",field:"ModifyDate",disabled:!0}]],searchFormFileds:{RoleName:"",DeptName:"",Enable:"",CreateDate:"",ModifyDate:""},searchFormOptions:[[{title:"角色名称",field:"RoleName",type:"text"},{title:"部门名称",field:"DeptName",type:"text"},{dataKey:"enable",title:"是否启用",field:"Enable",type:"select"}],[{title:"创建时间",field:"CreateDate",type:"datetime"},{title:"修改时间",field:"ModifyDate",type:"datetime"}]],columns:[{field:"Role_Id",title:"角色ID",type:"int",width:70,readonly:!0,require:!0,align:"left",sortable:!0},{field:"ParentId",title:"父级ID",type:"int",width:70,require:!0,align:"left"},{field:"RoleName",title:"角色名称",type:"string",link:!0,width:90,require:!0,align:"left"},{field:"Dept_Id",title:"部门ID",type:"int",width:90,hidden:!0,align:"left"},{field:"DeptName",title:"部门名称",type:"string",width:90,align:"left"},{field:"Enable",title:"是否启用",type:"byte",bind:{key:"enable",data:[]},width:90,align:"left"},{field:"OrderNo",title:"排序",type:"int",width:90,hidden:!0,align:"left"},{field:"Creator",title:"创建人",type:"string",width:130,readonly:!0,align:"left"},{field:"CreateDate",title:"创建时间",type:"datetime",width:90,readonly:!0,align:"left",sortable:!0},{field:"Modifier",title:"修改人",type:"string",width:130,readonly:!0,align:"left"},{field:"ModifyDate",title:"修改时间",type:"datetime",width:90,readonly:!0,align:"left",sortable:!0}],detail:{cnName:"#detailCnName",columns:[],sortName:"",key:""}}}},r={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("view-grid",{attrs:{columns:t.columns,detail:t.detail,editFormFileds:t.editFormFileds,editFormOptions:t.editFormOptions,searchFormFileds:t.searchFormFileds,searchFormOptions:t.searchFormOptions,table:t.table,extend:t.extend}})],1)},staticRenderFns:[]},a=i("VU/8")(o,r,!1,null,null,null);e.default=a.exports},OuMS:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE4AAABHCAIAAAAmx+aCAAAFKElEQVR4Ae1b6U9iMRBfEA8QEBS8D/CKu0YTE///mOxno4KoKOjiweWBCogH4P7MS14K772+tmg5DR/KdDqd30w7nU7RUq1Wf3XHn7U7YH6htGmhlkql8seHlt5elCG7vb+/n9S5BipAhvb2np+eSI42bVsslpm5ud/r66r+NQs4fnbWGTgB7/PzM3l9nU4m9aGWXl7Ujg5oIOJinapAaryqUjuy0UVQa8KS1pkut9tmM+HRjmoWBRvw9fXVaHYaDKvVGggGJ6enjQa3Gv0wFErd3Bhp1UULuAfVaBG0M73n1Xb2npHutAhsNIakIx3JpFKPuVy5XHY6nWN+v8/ns1hbcbGIQ30tlY4OD+/v7lTkuYeHq8vLPpttIRBYWllR6S3SEIT6cH9/eHDw9vamhVEpl89jMVwbNre2+vr6tAzNooistKfHx7ABThXG3e3tSSSifm2FhgjUeCz2rufPOjzpVIq8Q9X1yv/KDRUb8imXY1EUd6ikcZrGIuF7ebihYpci2DIqkc/ni4UCI7MuW6VS2d/dpWS2uqN0idxhibzs6kokidVKBaFr2OkkiextBSeMi+hgdzg8Xi/7WC0nt1e1IigUrOGPBipyCGzACfnv7+9H4TCXlbVacUPlur7isHE4HNpZWSiRUIjc6sVi8fTkhGWgEQ83VLfbzZ4MDQ4NoUhpNDeFjoJeiqiAKZy3mQzolFH0Lm6oSP3szNr7x8frirF0bZRe4LmIx1Hyq2MGJXFxIRyiuKEODg7Ozs+jylqnh/br8PAwKrFaOp1yc30NPFqcyigEKixjpNx0Ibq93FAhBSnulFkVZmBg4M/GBrv/FeXgsejREfDo6qoQhUOUCFRMub65ibKTkW+xP5EA854NCLbwGB2nghYhCkGLhZM0Gfe5qg5eWVtDhS12eqrc4BQ6QM7Mzi4Eg7yJPoSE9/fhMVU+vYGkDUcRLE5nI3vFoUIKSqdb29ukOLF2/vkZxT52nMosCNGwLPttUXABi0HSHYXEAP4UeEPhDchNhgqcePvD3tO1gimRKyA3EyoURXRp8O2PPSA3DSpwwp+ILqauM2VgDMhNg4r4iUqFKQxGBpjsLBqlMzcUgemiKb2RcJhM5Smc7F14OMZFj8LfBK9+pfI/UJ3Ajijk8y0E9ebq6t/5uVGKS1G08S7ZXh3xeATuOo3jhITvgZpNp//u7KAI9GJ2QjpdLv/ExLeoziuk0bD0Wa0i9F0mEliTqPffZrPIFpGs4aZqpArugNlMhqW8aiRBjN4QVPgQte+6HAAJLdyL7BSQAoGAtmThcrnGfL6fiEx0E4hDRbYdPT7+MLiLwMOxaBTFhMmpKTgZF3pSD9x+UD1hL7KSY4XbIlAR1pEAAKppIMX7DUIuTjy4Mbi87PF4FEW9o6OgZNJpYb0FBnJDxfpE4opaNvtksAgSI3zwKrmwuDg9M4OxWN54xZPpWD6oV4kEghC8yo6T5CwUCjATSg1z8/O4vo94vffflxuSE+m2WaGicn0cieDVWFcKFxHbG6+SqJXh4EHJxnQXcAmnMDNBxTsCvCF8q9SdHksDYnW7fohoAhWlWERRfIQX7Q/pLSCWBhVLC6m5QClEQA8JQ2iJIaB2DE6YkgZVgqVlTtGDKtPasubqeVWWpWXO0/OqTGvLmqvnVVmWljlPz6syrS1rrm71qntkRJaJZcyDX5OhUqvOVOPV5dVV1KONfsyhjmmLBn5sHlxa8vn9qraW3j9gq7bonEbNAu4cWHpIugjqf1AGc7Cf0XD8AAAAAElFTkSuQmCC"},UtSh:function(t,e){},dCQd:function(t,e){},fZjL:function(t,e,i){t.exports={default:i("jFbC"),__esModule:!0}},jFbC:function(t,e,i){i("Cdx3"),t.exports=i("FeBl").Object.keys},k6jg:function(t,e,i){"use strict";var n=i("mvHQ"),o=i.n(n),r=i("woOf"),a=i.n(r),s=i("Gu7T"),l=i.n(s),d={components:{"table-render":{name:"TableExpand",functional:!0,props:{render:Function,row:{},column:{},index:{type:Number,default:0}},render:function(t,e){var i={row:e.props.row,column:e.props.column,index:e.props.index};return e.props.render(t,i)}}},props:{tableData:{type:Array,default:function(){return[]}},columns:{type:Array,default:[]},height:{type:Number,default:0},maxHeight:{type:Number,default:0},linkView:{type:Function,default:function(){return 1}},pagination:{type:Object,default:function(){return{total:0,size:0,sortName:""}}},url:{type:String,default:""},paginationHide:{type:Boolean,default:!0},color:{type:Boolean,default:!0},index:{type:Boolean,default:!1},allowEmpty:{type:Boolean,default:!0},defaultLoadPage:{type:Boolean,default:!0},loadKey:{type:Boolean,default:!1},single:{type:Boolean,default:!1},doubleEdit:{type:Boolean,default:!0},clickEdit:{type:Boolean,default:!1},beginEdit:{type:Function,default:function(t,e,i){return!0}},endEditBefore:{type:Function,default:function(t,e,i){return!0}},endEditAfter:{type:Function,default:function(t,e,i){return!0}},ck:{type:Boolean,default:!0}},data:function(){return{visiblyColumns:[],key:"",realHeight:0,realMaxHeight:0,enableEdit:!1,empty:this.allowEmpty?"":"--",defaultImg:'this.src="'+i("OuMS")+'"',loading:!1,footer:{},total:0,formatConfig:{},defaultColor:"default",colors:["cyan","red","blue","green","magenta","geekblue","gold","orange","default"],rule:{phone:/^[1][3,4,5,6,7,8,9][0-9]{9}$/,decimal:/(^[\-0-9][0-9]*(.[0-9]+)?)$/,number:/(^[\-0-9][0-9]*([0-9]+)?)$/},columnNames:[],rowData:[],paginations:{sort:"",order:"desc",Foots:"",total:0,sizes:[30,60,100,120],size:30,Wheres:[],page:1,rows:30},errorFiled:"",edit:{columnIndex:-1,rowIndex:-1},editStatus:{},summary:!1,summaryData:[],summaryIndex:{},remoteColumns:[]}},created:function(){var t=this;this.realHeight=this.getHeight(),this.realMaxHeight=this.getMaxHeight();var e=[],i=[];this.summaryData.push("合计"),this.columns.forEach(function(n,o){n.hidden||(t.summaryData.push(""),t.summaryIndex[n.field]=t.summaryData.length),n.summary&&!t.summary&&(t.ck=!0,t.summary=!0),!n.bind||!n.bind.key||n.bind.data&&0!=n.bind.data.length||(n.bind.data||(n.bind.data=[]),n.bind.remote?t.remoteColumns.push(n):t.loadKey&&(e.push(n.bind.key),n.bind.valueTyoe=n.type,i.push(n.bind)))}),e.length>0&&this.http.post("/api/Sys_Dictionary/GetVueDictionary",e).then(function(t){t.forEach(function(t){i.forEach(function(e){var i;"int"!=e.valueTyoe&&"sbyte"!=e.valueTyoe||t.data.forEach(function(t){isNaN(t.key)||(t.key=~~t.key)}),e.key==t.dicNo&&(i=e.data).push.apply(i,l()(t.data))})})}),this.paginations.sort=this.pagination.sortName,a()(this.paginations,this.pagination),this.pagination.size&&(this.paginations.rows=this.pagination.size),this.enableEdit=this.columns.some(function(t){return t.hasOwnProperty("edit")});var n=this.columns.find(function(t){return t.isKey});n&&(this.key=n.field),this,this.defaultLoadPage&&this.load()},methods:{headerClick:function(t,e){this.clickEdit&&-1!=this.edit.rowIndex&&this.rowEndEdit(this.url?this.rowData[this.edit.rowIndex]:this.tableData[this.edit.rowIndex],t)&&(this.edit.rowIndex=-1)},rowClick:function(t,e,i){if(this.doubleEdit){if(this.clickEdit&&-1!=this.edit.rowIndex){if(t.elementIdex==this.edit.rowIndex)return void(this.columns.some(function(t){return t.field==(i.property||e.property)&&t.edit})||this.rowEndEdit(t,i)&&(this.edit.rowIndex=-1));this.rowEndEdit(t,i.propert?i:e)&&(this.edit.rowIndex=-1)}this.rowBeginEdit(t,e)}},dowloadFile:function(t){this.base.dowloadFile(t.path,t.name,{Authorization:this.$store.getters.getToken()},this.http.ipAddress)},getFilePath:function(t){if(!t)return"";for(var e=t.replace(/\\/g,"/").split(","),i=[],n=0;n<e.length;n++){var o=e[n];if(-1!=o.indexOf(".")){var r=o.split("/");r.length>0&&i.push({name:r[r.length-1],path:this.base.isUrl(o)?o:this.http.ipAddress+o})}}return i},reset:function(){this.tableData&&this.tableData.length>0&&this.tableData.splice(0),this.rowData&&this.rowData.length>0&&this.rowData.splice(0),this.paginationHide||(this.paginations.page=1,this.paginations.wheres&&this.paginations.wheres.length>0&&this.paginations.wheres.splice(0)),this.errorFiled="",this.edit.columnIndex=-1,this.edit.rowIndex=-1},getHeight:function(){return this.height||this.maxHeight?this.maxHeight?null:this.height:null},getMaxHeight:function(){return(this.height||this.maxHeight)&&this.maxHeight?this.maxHeight:null},getSelectedOptions:function(t){return t.bind&&t.bind.data&&t.bind.data.length>0?t.bind.data:[]},formatterClick:function(t,e,i){e.click&&e.click(t,e,i)},initIndex:function(t){return this.index&&(t.row.elementIdex=t.rowIndex),""},toggleEdit:function(t){},setEditStatus:function(t){var e=this;this.columns.forEach(function(i){i.hasOwnProperty("edit")&&e.$set(i.edit,"status",t)})},beginWithButtonEdit:function(t){this.rowBeginEdit(t.row,this.columns[t.$index])},endWithButtonEdit:function(t){if(-1!=this.edit.rowIndex&&this.endEditBefore(t.row,this.columns[t.$index],t.$index)){for(var e=0;e<this.columns.length;e++){var i=this.columns[e];if(!i.hidden&&(i.required||i.require)&&!this.validateColum(i,t.row))return}this.edit.rowIndex=-1,this.endEditAfter(t.row,this.columns[t.$index],t.$index)}},rowBeginEdit:function(t,e){if(-1==this.edit.rowIndex&&this.enableEdit&&this.beginEdit(t,e,t.elementIdex)&&t.hasOwnProperty("elementIdex")){if(this.edit.rowIndex==t.elementIdex)return;this.edit.rowIndex=t.elementIdex}},validateColum:function(t,e){if(t.hidden||t.bind)return!0;var i=e[t.field];if((t.require||t.required)&&"0"!=i&&(""==i||void 0==i))return this.errorFiled||this.$Message.error(t.title+"不能为空"),!1;if(!t.edit)return!0;var n=t.edit.type;if("int"==n||"decimal"==n||"number"==n){if(""==i||void 0==i)return!0;if("decimal"==n){if(!this.rule.decimal.test(i))return this.$Message.error(t.title+"只能是数字"),!1}else if(!this.rule.decimal.test(i))return this.$Message.error(t.title+"只能是整数"),!1;return void 0!=t.edit.min&&"number"==typeof t.edit.min&&i<t.edit.min?(this.$Message.error(t.title+"不能小于"+t.edit.min),!1):!(void 0!=t.edit.max&&"number"==typeof t.edit.max&&i>t.edit.max)||(this.$Message.error(t.title+"不能大于"+t.edit.max),!1)}return!i||"text"!=n&&"string"!=n||(void 0!=t.edit.min&&"number"==typeof t.edit.min&&i.length<t.edit.min?(this.$Message.error(t.title+"至少"+t.edit.min+"个字符"),!1):!(void 0!=t.edit.max&&"number"==typeof t.edit.max&&i.length>t.edit.max)||(this.$Message.error(t.title+"最多"+t.edit.max+"个字符"),!1))},rowEndEdit:function(t,e,i){if(this.clickEdit&&i)return!0;if(!this.enableEdit)return this.errorFiled||(this.edit.rowIndex=-1),!0;if(!this.doubleEdit&&i)return!0;if(!this.endEditBefore(t,e,this.edit.rowIndex))return!1;if(-1!=this.edit.rowIndex&&(!this.errorFiled||this.errorFiled==e.property)){var n=(this.url?this.rowData:this.tableData)[this.edit.rowIndex],o=this.columns.find(function(t){return t.field==e.property});if(!o||!o.edit)return!0;if(("datetime"==o.edit.type||"date"==o.edit.type||"select"==o.edit.type)&&this.edit.rowIndex==t.elementIdex)return!0;if(!this.validateColum(o,n))return this.errorFiled=o.field,!1;this.errorFiled=""}return!this.errorFiled&&(!!this.endEditAfter(t,e,this.edit.rowIndex)&&(this.edit.rowIndex=-1,!0))},delRow:function(){var t=this.getSelected();if(0==t.length)return this.$Message.error("请选择要删除的行!");var e=this.url?this.rowData:this.tableData,i=this.getSelectedIndex();if(0==i.length)return this.$Message.error("删除操作必须设置VolTable的属性index='true'");if(0==i.length);else for(var n=e.length-1;n>=0;n--)-1!=i.indexOf(n)&&e.splice(n,1);return this.edit.rowIndex=-1,t},addRow:function(t){t||(t={}),this.columns.forEach(function(e){t.hasOwnProperty(e.field)||(e.edit&&"switch"==e.edit.type?t[e.field]="bool"!=e.type&&0:t.hidden||(t[e.field]=void 0))}),this.url?this.rowData.push(t):this.tableData.push(t)},viewImg:function(t,e,i){this.base.previewImg(i,this.http.ipAddress)},link:function(t,e){this.$props.linkView(t,e)},getSelected:function(){return this.$refs.table.selection},getSelectedIndex:function(){if(!this.index)return[];var t=this.$refs.table.selection.map(function(t){return t.elementIdex});return t||[]},GetTableDictionary:function(t){var e=this;if(0!=this.remoteColumns.length&&t&&0!=t.length){for(var i={},n=function(n){var o=e.remoteColumns[n],r=o.bind.key,a=[];t.forEach(function(t){-1==a.indexOf(t[o.field])&&a.push(t[o.field])}),a.length>0&&(i[r]=a)},o=0;o<this.remoteColumns.length;o++)n(o);0!=i.length&&this.http.post("/api/Sys_Dictionary/GetTableDictionary",i).then(function(t){t.forEach(function(t){e.remoteColumns.forEach(function(e){e.bind.key==t.key&&(e.bind.data=a()([],e.bind.data,t.data))})})})}},load:function(t,e){var i=this;if(this.url){e&&this.resetPage();var n={page:this.paginations.page,rows:this.paginations.rows,sort:this.paginations.sort,order:this.paginations.order,wheres:[]},r=!0;t&&(n=a()(n,t)),this.$emit("loadBefore",n,function(t){r=t}),r&&(n.wheres&&n.wheres instanceof Array&&(n.wheres=o()(n.wheres)),this.loading=!0,this.http.post(this.url,n).then(function(t){i.loading=!1,i.$emit("loadAfter",t.rows||[],function(t){r=t}),r&&(i.GetTableDictionary(t.rows),i.rowData=t.rows||[],i.paginations.total=t.total,i.getSummaries(t))},function(t){i.loading=!1}))}},getSummaries:function(t){var e=this;this.summary&&t.summary&&(this.summaryData.splice(0),this.ck&&this.summaryData.push(0),this.columns.forEach(function(i){i.hidden||(t.summary.hasOwnProperty(i.field)?e.summaryData.push(t.summary[i.field]):e.summaryData.push(""))}),this.summaryData.length>0&&""==this.summaryData[0]&&(this.summaryData[0]="合计"))},getInputChangeSummaries:function(){},filterColumns:function(){return this.columns.filter(function(t){return!t.hidden})},handleSizeChange:function(t){this.paginations.rows=t,this.load()},handleCurrentChange:function(t){this.paginations.page=t,this.load()},sortChange:function(t){this.paginations.sort=t.prop,this.paginations.order="ascending"==t.order?"asc":"desc",this.load()},resetPage:function(){this.paginations.page=1},selectionChange:function(t){this.single&&1==t.length&&this.$emit("rowChange",t[0]),this.single&&t.length>1&&this.$refs.table.toggleRowSelection(t[0])},getColor:function(t,e){var i=t[e.field];if(e.getColor&&"function"==typeof e.getColor){var n=e.getColor(t,e);if(n)return n}if(!i&&"0"!=i)return this.defaultColor;if(!this.formatConfig[e.field])return this.formatConfig[e.field]=[i],this.colors[0];var o=this.formatConfig[e.field].indexOf(i);return-1!=o?this.colors[o]:this.formatConfig[e.field].length>15?this.defaultColor:(-1==o&&(this.formatConfig[e.field].push(i),o=this.formatConfig[e.field].length-1),this.colors[o])},formatterDate:function(t,e){return(t[e.field]||"").substr(0,10)},formatter:function(t,e,i){if(!i)return t[e.property];var n=t[e.field];if(e.edit&&"switch"==e.edit.type)return n?"是":"否";if(!e.bind||!e.bind.data)return t[e.field];if(!n&&0!=n)return n;if(("selectList"==e.bind.type||"checkbox"==e.bind.type)&&"string"==typeof n&&-1!=n.indexOf(","))return this.getSelectFormatter(e,n);var o=e.bind.data.filter(function(t){return""!==t.key&&void 0!==t.key&&t.key+""==n+""});return o&&o.length>0&&(n=o[0].value),n},getSelectFormatter:function(t,e){for(var i=e.split(","),n=function(e){t.bind.data.forEach(function(t){""!==t.key&&void 0!==t.key&&t.key+""==i[e]+""&&(i[e]=t.value)})},o=0;o<i.length;o++)n(o);return i.join(",")},onChange:function(t,e,i,n){var o=t.row;n.onChange&&!n.onChange(o,e,i)||this.getInputSummaries(t,e,i,n)},getInputSummaries:function(t,e,i,n){if(n.summary){var o=0;(this.url?this.rowData:this.tableData).forEach(function(t,e){t.hasOwnProperty(n.field)&&!isNaN(t[n.field])&&(e,o+=1*t[n.field])}),this.$set(this.summaryData,this.summaryIndex[n.field]-1,o)}}}},h={render:function(){var t=this,e=this,i=e.$createElement,n=e._self._c||i;return n("div",[n("div",{staticClass:"vol-table"},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"mask"}),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"message"},[e._v("加载中.....")]),e._v(" "),n("el-table",{ref:"table",staticClass:"v-table",staticStyle:{width:"100%"},attrs:{"show-summary":e.summary,"summary-method":function(e,i){return t.summaryData},"tooltip-effect":"dark",height:e.realHeight,"max-height":e.realMaxHeight,data:e.url?e.rowData:e.tableData,border:"","row-class-name":e.initIndex},on:{"selection-change":e.selectionChange,"row-click":e.rowClick,"header-click":e.headerClick,"cell-mouse-leave":function(e,i,n){!t.clickEdit&&t.rowEndEdit(e,i,n)},"sort-change":e.sortChange}},[e.ck?n("el-table-column",{attrs:{type:"selection",width:"55"}}):e._e(),e._v(" "),e._l(e.filterColumns(),function(t,i){return n("el-table-column",{key:i,attrs:{prop:t.field,label:t.title,"min-width":t.width,formatter:e.formatter,fixed:t.fixed,align:t.align,sortable:!!t.sort&&"custom"},scopedSlots:e._u([{key:"default",fn:function(i){return[t.render&&"function"==typeof t.render?n("table-render",{attrs:{row:i.row,index:i.$index,column:t,render:t.render}}):t.edit?n("div",{staticClass:"edit-el"},[t.edit.keep||e.edit.rowIndex==i.$index?n("div",{staticClass:"e-item"},[n("div",["date"==t.edit.type||"datetime"==t.edit.type?n("DatePicker",{attrs:{transfer:!0,type:t.edit.type,format:"date"==t.edit.type?"yyyy-MM-dd":"yyyy-MM-dd HH:mm:ss",placeholder:t.title,value:i.row[t.field]},on:{"on-change":function(e){return i.row[t.field]=e,t.onChange&&t.onChange(e,t),e}}}):"switch"==t.edit.type?n("i-switch",{attrs:{"true-value":"boolean"==typeof i.row[t.field]||1,"false-value":"boolean"!=typeof i.row[t.field]&&0},on:{"on-change":function(n){t.onChange&&t.onChange(t,i.row,e.url?e.rowData:e.tableData,n)}},model:{value:i.row[t.field],callback:function(n){e.$set(i.row,t.field,n)},expression:"scope.row[column.field]"}},[n("span",{attrs:{slot:"open"},slot:"open"},[e._v("是")]),e._v(" "),n("span",{attrs:{slot:"close"},slot:"close"},[e._v("否")])]):"select"==t.edit.type?n("Select",{attrs:{transfer:!0,filterable:!!(t.filter||e.getSelectedOptions(t).length>10),placeholder:"请选择"+t.title,clearable:""},on:{"on-change":function(n){t.onChange&&t.onChange(t,i.row,e.url?e.rowData:e.tableData)}},model:{value:i.row[t.field],callback:function(n){e.$set(i.row,t.field,n)},expression:"scope.row[column.field]"}},e._l(e.getSelectedOptions(t),function(t,i){return n("Option",{key:i,attrs:{value:void 0===t.key?"":t.key}},[e._v(e._s(t.value))])}),1):n("Input",{ref:t.field+i.$index,refInFor:!0,attrs:{clearable:"",placeholder:"请输入"+t.title},on:{"on-change":function(n){e.onChange(i,i.row[t.field],n,t)},"on-keypress":function(e){t.onKeyPress&&t.onKeyPress(e,i,t)}},model:{value:i.row[t.field],callback:function(n){e.$set(i.row,t.field,n)},expression:"scope.row[column.field]"}})],1),e._v(" "),t.extra&&e.edit.rowIndex==i.$index?n("div",{staticClass:"extra"},[n("a",{style:t.extra.style,on:{click:function(){t.extra.click&&t.extra.click(t,i.row,e.url?e.rowData:e.tableData)}}},[t.extra.icon?n("Icon",{attrs:{type:t.extra.icon}}):e._e(),e._v("\n                  "+e._s(t.extra.text)+"\n                ")],1)]):e._e()]):[t.formatter?n("div",{domProps:{innerHTML:e._s(t.formatter(i.row,t))}}):n("div",[e._v(e._s(e.formatter(i.row,t,!0)))])]],2):n("div",[t.link?n("a",{attrs:{href:"javascript:void(0)"},domProps:{textContent:e._s(i.row[t.field])},on:{click:function(n){e.link(i.row,t)}}}):"img"==t.type?e._l(e.getFilePath(i.row[t.field]),function(o,r){return n("img",{key:r,staticClass:"table-img",attrs:{onerror:e.defaultImg,src:o.path},on:{click:function(n){e.viewImg(i.row,t,o.path)}}})}):"file"==t.type||"excel"==t.type?e._l(e.getFilePath(i.row[t.field]),function(t,i){return n("a",{key:i,staticClass:"t-file",staticStyle:{"margin-right":"15px"},on:{click:function(i){e.dowloadFile(t)}}},[e._v(e._s(t.name))])}):"date"==t.type?n("Tag",[e._v(e._s(e.formatterDate(i.row,t)))]):t.formatter?n("div",{domProps:{innerHTML:e._s(t.formatter(i.row,t))},on:{click:function(n){e.formatterClick(i.row,t)}}}):t.bind&&t.normal?n("div",{style:t.getStyle&&t.getStyle(i.row,t),on:{click:function(n){e.formatterClick(i.row,t)}}},[e._v("\n              "+e._s(e.formatter(i.row,t,!0))+"\n            ")]):t.click?n("div",{on:{click:function(n){e.formatterClick(i.row,t)}}},[e._v("\n              "+e._s(i.row[t.field])+"\n            ")]):t.bind?n("Tag",{attrs:{color:e.getColor(i.row,t)}},[e._v(e._s(e.formatter(i.row,t,!0)))]):n("div",[e._v(e._s(e.formatter(i.row,t,!0)))])],2)]}}])})}),e._v(" "),e.doubleEdit?e._e():n("el-table-column",{attrs:{"min-width":100,label:"操作",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("Button",{attrs:{type:"info",size:"small",ghost:""},on:{click:function(i){e.beginWithButtonEdit(t)}}},[e._v("编辑")]),e._v(" "),n("Button",{attrs:{type:"info",size:"small",ghost:""},on:{click:function(i){e.endWithButtonEdit(t)}}},[e._v("完成")])]}}])})],2)],1),e._v(" "),e.paginationHide?e._e():n("div",{staticClass:"block pagination"},[n("el-pagination",{attrs:{"current-page":e.paginations.page,"page-sizes":e.paginations.sizes,"page-size":e.paginations.size,layout:"total, sizes, prev, pager, next, jumper",total:e.paginations.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])},staticRenderFns:[]};var u=i("VU/8")(d,h,!1,function(t){i("UtSh"),i("w72T")},"data-v-37598e34",null);e.a=u.exports},lJIO:function(t,e){},oWYQ:function(t,e){},uqUo:function(t,e,i){var n=i("kM2E"),o=i("FeBl"),r=i("S82l");t.exports=function(t,e){var i=(o.Object||{})[t]||Object[t],a={};a[t]=e(i),n(n.S+n.F*r(function(){i(1)}),"Object",a)}},w72T:function(t,e){}});